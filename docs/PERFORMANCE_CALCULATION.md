# パフォーマンス計算

## 新しいデフォルト設定での処理能力

### リマインダー通知（DM送信）
- **バッチサイズ**: 20
- **遅延**: 100ms
- **理論上の処理速度**: 12,000通知/分

**実際の制限**:
- DM作成制限: 60 DM/分（5 DM/5秒）
- グローバル制限: 3,000リクエスト/分（50/秒）
- **実効処理速度**: 60 DM/分

### 締切通知（チャンネルメッセージ）
- **バッチサイズ**: 15
- **遅延**: 100ms
- **理論上の処理速度**: 9,000通知/分（18,000 APIコール/分）

**実際の制限**:
- グローバル制限: 3,000リクエスト/分（50/秒）
- チャンネルごと: 60メッセージ/分
- **実効処理速度**: 1,500通知/分（3,000 APIコール÷2）

## Worker実行時間での処理量

15秒のWall時間内で:

### 理論値
- **リクエスト数**: 750（50/秒 × 15秒）
- **バッチ数**: 150（15秒 ÷ 0.1秒）

### 実際の処理量
- **リマインダー（DM）**: 最大15 DM（DM制限により）
- **締切通知**: 最大375通知（750リクエスト÷2）

## スケール戦略

### 〜1,000スケジュール
- 現在の設定で十分
- 1回のWorker実行で処理可能

### 1,000〜10,000スケジュール
- バッチサイズを30-40に増加
- 複数回の実行に分割を検討

### 10,000スケジュール以上
- Cloudflare Queuesの導入
- 複数Workerでの並列処理
- カスタムレート制限実装

## 最適化のポイント

1. **DM送信は別扱い**: 60/分の制限があるため特別な処理が必要
2. **チャンネル分散**: 同一チャンネルへの連続送信を避ける
3. **エラー処理**: 429エラーは自動リトライ
4. **監視**: X-RateLimit-Remainingヘッダーを活用